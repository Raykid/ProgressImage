var utils;(function(utils){var _oriAttrsDict={};function getTarget(obj,key){var target=obj;while(true){if(target==null)return obj;if(target.hasOwnProperty(key))break;target=typeof target=="function"?target.prototype:target["__proto__"]}return target}function changeProperty(obj,key,attrs){var target=getTarget(obj,key);var oriAttrs=Object.getOwnPropertyDescriptor(target,key);_oriAttrsDict[target.constructor.name+"_"+key]=oriAttrs;Object.defineProperty(target,key,attrs);Object.defineProperty(target,"$"+key,{configurable:oriAttrs.configurable,enumerable:oriAttrs.enumerable,get:function(){Object.defineProperty(target,key,oriAttrs);var res=this[key];Object.defineProperty(target,key,attrs);return res},set:function(value){Object.defineProperty(target,key,oriAttrs);this[key]=value;Object.defineProperty(target,key,attrs)}})}utils.changeProperty=changeProperty;function recoverProperty(obj,key){var target=getTarget(obj,key);var tempKey=target.constructor.name+"_"+key;var oriAttrs=_oriAttrsDict[tempKey];delete _oriAttrsDict[tempKey];if(oriAttrs==null)return obj;Object.defineProperty(target,key,oriAttrs);delete target["$"+key];return obj}utils.recoverProperty=recoverProperty})(utils||(utils={}));var utils;(function(utils){function openProgressImage(){utils.changeProperty(HTMLImageElement,"src",utils["_propDesc"])}utils.openProgressImage=openProgressImage;function closeProgressImage(){utils.recoverProperty(HTMLImageElement,"src")}utils.closeProgressImage=closeProgressImage})(utils||(utils={}));(function(){var waitXHR=[];function queueSendXHR(xhr){if(waitXHR.indexOf(xhr)<0){waitXHR.push(xhr);xhr.addEventListener("abort",nextXHR);xhr.addEventListener("error",nextXHR);xhr.addEventListener("timeout",nextXHR);xhr.addEventListener("load",nextXHR);nextXHR.call(xhr)}}function nextXHR(){var xhr=this;if(waitXHR.indexOf(xhr)==0){if(xhr.readyState==XMLHttpRequest.DONE){xhr.removeEventListener("abort",nextXHR);xhr.removeEventListener("error",nextXHR);xhr.removeEventListener("timeout",nextXHR);xhr.removeEventListener("load",nextXHR);waitXHR.shift()}xhr=waitXHR[0];if(xhr&&xhr.readyState==XMLHttpRequest.OPENED){xhr.send()}}}utils["_propDesc"]={enumerable:true,configurable:true,get:function(){return this.__oriSrc},set:function(value){this.__oriSrc=value;var self=this;var protocol=value.substring(0,value.indexOf(":"));if(protocol=="http"||protocol=="https"||protocol==""){if(this._xhr==null){this._xhr=new XMLHttpRequest;this._xhr.responseType="arraybuffer";this._xhr.addEventListener("abort",middleListener);this._xhr.addEventListener("error",middleListener);this._xhr.addEventListener("loadend",middleListener);this._xhr.addEventListener("loadstart",middleListener);this._xhr.addEventListener("progress",middleListener);this._xhr.addEventListener("timeout",middleListener);this._xhr.addEventListener("load",function(){var blob=new Blob([self._xhr.response]);var url=URL.createObjectURL(blob);self.$src=url;setTimeout(URL.revokeObjectURL,0,url)})}if(this._xhr.status!=XMLHttpRequest.UNSENT)this._xhr.abort();this._xhr.open("GET",value,true);queueSendXHR(this._xhr)}else{this.$src=value}function middleListener(evt){var newEvt=document.createEvent("Event");newEvt.initEvent(evt.type,evt.bubbles,evt.cancelable);newEvt.lengthComputable=evt.lengthComputable;newEvt.loaded=evt.loaded;newEvt.total=evt.total;self.dispatchEvent(newEvt)}}}})();